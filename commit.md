[<К содержанию](./readme.md)

## git commit

По-научному это *сохранение состояния, фиксация или слепок изменений*.

Чуть менее научно, коммит - *зафиксированный набор изменений*, который показывает, какие файлы изменились и что именно в них изменилось. 

## Как сделать коммит

Представим, что мы добавляем блок учеников на сайт. Добавляем новую разметку в *index.html* и новые стили в *main.css*. Чтобы сохранить изменения, нужно их закоммитить. Но предварительно сообщить **git**, какие именно файлы мы хотим положить в коммит. Команда **git add** добавляет (или подготавливает) файлы к коммиту. Можно добавить файлы по отдельности, вот так

``````brash=
    $ git add index.html
    $ git add css/main.css
``````

А можно все сразу

``````brash=
    $ git add.
``````

Добавлять все файлы сразу удобно, но стоит всегда внимательно проверять, точно ли мы хотим добавить в коммит все измененные файлы. Если ошиблись и какой-то файл добавлять в коммит не нужно, то можно исключить этот файл из подготовленных.

``````brash=
    $ git reset css/main.css
``````

``````brash=
    $ git commit -m 'Added block students'
``````

Флаг *-m* задает сообщение коммита **(commit message)**. Оно нужно, чтобы описать изменения, которые делает этот коммит. Подписывайте коммиты так, чтобы было понятно, что в нем происходит.
Состояние файлов в **git**. Измененные и подготовленные файлы
Измененные файлы - это те файлы, которые мы успели изменить с момента последнего коммита

Подготовленные файлы отличаются от измененных тем, что они "подготовлены" к коммиту, то есть будут добавлены в следующий коммит.

*git add filename* добавляет или подготавливает файл к коммиту.
*git reset filename* удаляет файл из подготовленных к коммиту.

Содержимое файлов при этом не меняется. Один файл может одновременно находиться и в измененных, и в подготовленных. Это происходит, если мы добавили файл, но не закоммитили и продолжили делать в нем измения.

## Из чего состоит коммит

Каждый коммит имеет:

- **хэш** (уникальный id), *например*, 239892a996...4784cf57f7
- **commit message** (сообщение), *например* "Added block news"
- **список измененных файлов**, *например*, index.html и css/main.css
- **изменения по каждому файлу**, это то же самое, что показывает команда *git diff*

---

---

## Как добавить файлы и сделать коммит одной командой

    
```brash=
    $ git commit -a -m 'Commit message`
``````

### Отслеживаемые и неотслеживаемые файлы

- Отслеживаемые файлы - это те, в которых **git** отлавливает изменения и показывает их через ***git status*** и ***git diff***. В нашем проекте файлы *index.html и css/main.css* - отслеживаемые.

- Неотслеживаемые файлы - это файлы, изменения в которых **git** не отлавливает. Новый файл в проекте по умолчанию попадает в неотслеживаемые. Добавить новый файл в рабочую область **git** можно командой ***git add filename***

### История коммитов

Все коммиты можно посмотреть в истории коммитов. История хранит все данные обо всех коммитах проекта. Показывается история командой


    $ git log

История включает в себя все сведения о коммитах: 
- хэш, 
- автор, 
- дата, 
- список изменений. 

Список изменений смотреть командой ***git show*** по *хэшу коммита*


    $ git show hash_commit

Переименование последнего коммита, ***git commit --amend***

Если мы сделали коммит, но хотим поправить его *commit message*


    $ git commit --amend -m 'New commit message'

Эта команда перезапишет сообщение последнего коммита. Это перезаписывание истории, операция опасная. Лучше делать ее только до того, как отправили коммит на сервер.

Откат коммитов, ***git revert***

Если мы сделали неверный коммит и хотим откатить изменения, сделанные в нем, то поможет команда ***git revert***


    $ git revert hash_commit

При этом откроется дефолтный текстовый редактор, который предолжит ввести ***commit message***. Если мы хотим оставить ***commit message*** по умолчанию, то можно обойтись без открытия редактора с помощью флажка *--no-edit*


    $ git revert --no-edit hash_commit

### Работа с файлами

При работе с файлами нужно учесть, что новые файлы **git** отправляет в неотслеживаемые. Поэтому при добавлении нового файла стоит сначала его закоммитить, а потом вносить изменения, чтобы они были доступны через ***git diff***

При обычном переименовании файла в файловом менеджере или командой ***mv git*** сначала показывает 2 файла: 
- старый удаленный 
- новый неотслеживаемый.

 Чтобы **git** понял, что этот файл именно переименованный, нужно сначала добавить эти файлы в подготовленные к коммиту


    $ git add 

Тогда при команде ***git status*** файл будет отображаться именно как переименованный

Можно избежать этого промежуточного состояния, если переименовать файл в командной строке таким образом


    $ git mv about.html company.html


Тогда файл будет сразу отображаться, как переименованный. То же самое с удалением файла


    $ git rm about.html